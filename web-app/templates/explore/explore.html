<!-- home page / explore page -->

{% extends "base.html" %}

{% block title %}Explore{% endblock %}

{% block content %}
<div class="explore-page">
    <!-- <h1 class="explore-title">Explore Events</h1> -->

    <form method="GET" action="{{ url_for('explore.search_events') }}" class="search-form" id="search-form">
        <input type="text" name="q" class="search-input" placeholder="Search events..." value="{{ request.args.get('q', '') }}">
        <button type="submit" class="search-button" id="search-btn">
            <svg class="search-icon">
                <use href="../../static/images/icons.svg#icon-search"></use>
            </svg>
        </button>
    </form>

    {% if query %}
        <p class="search-results-text">Showing results for "{{ query }}"</p>
        <button onclick="history.back()" class="no-events back-button" style="padding: 0px; margin: 0px;">Go back</button>
    {% endif %}
    
    

    {% if events %}
    <div class="event-grid">
        {% for event in events %}
            <a href="{{ url_for('explore.event_detail', event_id=event.id) }}" class="event-card">
                <img src="{{ url_for('event.get_image', image_id=event.image_id) }}" alt="{{ event.title }}" class="event-img">
            </a>
        {% endfor %}
    </div>
    {% else %}
        <div class="event-grid">
            <p class="no-events">No events found.</p>
        </div>
    {% endif %}

</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const colors = ["#EEBEDC", "#F4DD81", "#BDCBE9", "#BAC693"]
    
        const searchInput = document.querySelector(".search-input")
        const searchButton = document.getElementById("search-btn")
        const searchForm = document.getElementById("search-form")
    
        const randomFocusColor = colors[Math.floor(Math.random() * colors.length)];
        const randomButtonColor = colors[Math.floor(Math.random() * colors.length)];
    
        searchButton.style.backgroundColor = randomButtonColor;
    
        searchInput.addEventListener("focus", () => {
            searchInput.style.borderColor = randomFocusColor
        });
        searchInput.addEventListener("blur", () => {
            searchInput.style.borderColor = "#888"
        });
    
        searchButton.addEventListener("mouseenter", () => {
            searchButton.style.transition = "background-color 0.3s ease";
            searchButton.style.backgroundColor = "#000"
        });
    
        searchButton.addEventListener("mouseleave", () => {
            searchButton.style.backgroundColor = randomButtonColor;
        });
    
        let searchOpen = false;
    
        searchButton.addEventListener("click", (e) => {
            if (!searchOpen) {
                e.preventDefault();
                searchInput.classList.add("show")
                searchInput.focus();
                searchOpen = true;
            } else if (searchInput.value.trim() === "") {
                e.preventDefault();
                searchInput.classList.remove("show");
                searchInput.blur();
                searchOpen = false;
            } 
        });
    });
</script>    
{% endblock %}